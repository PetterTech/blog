<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Exchange | PetterTech</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/tags/exchange/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bf5f9f73cf17311d52cedbcda82c922e91b2f566d88a85ad9f5b5a08b586bd5f.css" integrity="sha256-v1&#43;fc88XMR1SztvNqCySLpGy9WbYioWtn1taCLWGvV8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/apple-touch-icon.png">
<link rel="mask-icon" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/tags/exchange/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Exchange" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/tags/exchange/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Exchange"/>
<meta name="twitter:description" content=""/>

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net" accesskey="h" title="PetterTech (Alt + H)">PetterTech</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>
    Exchange
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Exchange: Content index state failed
    </h2>
  </header>
  <div class="entry-content">
    <p>If you ever had problems with corrupt databases in an Exchange 2010 DAG setup you might have encountered this error. Trying to activate the database on a server where it has this state will fail.
However there is a quite simple fix given that you have a healthy copy of the database on a different server:
Update-MailboxDatabaseCopy -Identity DB -SourceServer -CatalogOnly
Run the command in the Exchange Management Shell and it should fix the Content index state and allow you to activate the database again....</p>
  </div>
  <footer class="entry-footer"><span title='2013-01-16 09:17:13 +0000 +0000'>January 16, 2013</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Exchange: Content index state failed" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2013/01/16/exchange-content-index-state-failed/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Exchange: Activate Database Copy fails
    </h2>
  </header>
  <div class="entry-content">
    <p>After some exchange services failed on one of the nodes in our Exchange 2010 DAG we got some problems with one database. The database was mounted on server2 where it has an activation preference of 2.
Trying to manually activate the database on server1, where is has an activation preference of 1, resulted in the following error:
——————————————————–
Microsoft Exchange Error
——————————————————–
Cannot activate database copy ‘Activate Database Copy…’.
Activate Database Copy…...</p>
  </div>
  <footer class="entry-footer"><span title='2013-01-16 09:07:50 +0000 +0000'>January 16, 2013</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Exchange: Activate Database Copy fails" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2013/01/16/activate-database-copy-fails/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Function for locating an email address
    </h2>
  </header>
  <div class="entry-content">
    <p>Yesterday I was given a relatively easy task: find out who or what has a given email address.
As this was within our own Exchange organization it proved to be quite simple:
You can achieve the goal with a simple one-liner:
But wouldn’t it be easier to have it in a function? In Powershell, creating functions isn’t all that hard. Basically all you need to do is wrap the command or script block with a function statement, see here:...</p>
  </div>
  <footer class="entry-footer"><span title='2012-08-28 10:41:15 +0000 +0000'>August 28, 2012</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Function for locating an email address" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/08/28/function-for-locating-an-email-address/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Check if DAG databases is on preferred server
    </h2>
  </header>
  <div class="entry-content">
    <p>If you are using DAG in exchange 2010 for high availability on your mailboxes there may be one thing you might have noticed, the databases can fail over to a less preferred server at any time without you noticing.
Microsoft have provided you with a script for balancing these databases, RedistributeActiveDatabases.ps1. With this script you can activate the databases on their preferred server again. But how do you know when they have failed over?...</p>
  </div>
  <footer class="entry-footer"><span title='2012-04-30 10:35:57 +0000 +0000'>April 30, 2012</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Check if DAG databases is on preferred server" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/04/30/check-if-dag-databases-is-on-preferred-server/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Mass import of users in Active Directory v2 – Powershell time
    </h2>
  </header>
  <div class="entry-content">
    <p>Earlier I posted a script that created users and homefolders and added the users to specified groups. It also set ntfs permissions on the homefolders.
That script used primarily old fashioned stuff, so I sat down and started looking for a neat way to do the same in powershell.
The powershell script I came up does a lot more than the last one. Here a little list:
Creates OUs Creates users Creates security groups Creates distribution groups Creates mailboxes for all users Add specified users to the correct security and distribution groups Creates a homefolder root folder and shares it Creates a homefolder for each user and sets ntfs permissions Set storage limit on the exchange mailbox database As you can see, it does quite a lot....</p>
  </div>
  <footer class="entry-footer"><span title='2011-10-27 19:54:21 +0000 +0000'>October 27, 2011</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Mass import of users in Active Directory v2 – Powershell time" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/10/27/mass-import-of-users-in-active-directory-v2-powershell-time/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Install and configure Exchange 2010 using Powershell
    </h2>
  </header>
  <div class="entry-content">
    <p>In this guide I will show you how to install and configure a simple Exchange 2010 environment using no gui at all.
Installing exchange 2010 without gui may seem kinda nerdy, but it’s quite useful for quickly setting up a test environment for example.
Remember to run Windows update prior to the installation.
Start powershell as administrator and type:
First we need to install all of the prerequisites:
We also need to set the NetTcpPortSharing service to automatic start, the command for this is:...</p>
  </div>
  <footer class="entry-footer"><span title='2011-09-29 06:51:38 +0000 +0000'>September 29, 2011</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Install and configure Exchange 2010 using Powershell" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/29/install-and-configure-exchange-2010-using-powershell/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Enable Resource Booking Attendant on all Room Mailboxes
    </h2>
  </header>
  <div class="entry-content">
    <p>The Resource Booking Attendant should be enabled on all your Room Mailboxes. If it is not, the room will not accept or decline incoming meeting requests. Which is somewhat the whole point right?
Heres a powershell command to enable it on all the Room Mailboxes in an exchange organization:</p>
  </div>
  <footer class="entry-footer"><span title='2011-09-12 12:28:56 +0000 +0000'>September 12, 2011</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Enable Resource Booking Attendant on all Room Mailboxes" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/12/enable-resource-booking-attendant-on-all-room-mailboxes/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Editing permissions on all mailboxes in one command, Exchange 2010/2007
    </h2>
  </header>
  <div class="entry-content">
    <p>If you have some sort of 3rd-party application that needs access to all of your mailboxes, it can be a pain to set the permissions on all of your mailboxes.
Except if you use this nice little powershell command:
What this command will do is to add Full mailbox access to every mailbox in your Exchange organization for the user admin.
You can of course change the -AccessRights setting to your liking, e....</p>
  </div>
  <footer class="entry-footer"><span title='2011-08-18 07:44:23 +0000 +0000'>August 18, 2011</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Editing permissions on all mailboxes in one command, Exchange 2010/2007" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/18/editing-permissions-on-all-mailboxes-in-one-command-exchange-20102007/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Receive connector allowing anonymous relay on exchange 2010/2007
    </h2>
  </header>
  <div class="entry-content">
    <p>Often it’s a good idea to have a receive connector allowing certain devices to send mail through you exchange server without having to authenticate.
One example from where I currently work is printers.
We never set up the printers ourselves, that job is done by the provider. And do we want to give them a username and password allowing for mail relay through our servers? No, we don’t.
It’s a better practice to have them only input the name/ip-address of one exchange server with the cas role....</p>
  </div>
  <footer class="entry-footer"><span title='2011-08-17 14:27:32 +0000 +0000'>August 17, 2011</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Receive connector allowing anonymous relay on exchange 2010/2007" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/17/receive-connector-allowing-anonymous-relay-on-exchange-20102007/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Activesync issue on Exchange 2010
    </h2>
  </header>
  <div class="entry-content">
    <p>At work we are currently migrating to a new active directory domain. The migration hos gone rather smoothly except for a couple of users who are not able to sync mail on their phones.
After a little research I found the following events in the event log on our exchange CAS server:
Log Name: Application
Source: MSExchange ActiveSync
Date: 04.08.2011 11:00:48
Event ID: 1053
Task Category: Configuration
Level: Error
Keywords: Classic...</p>
  </div>
  <footer class="entry-footer"><span title='2011-08-04 09:56:46 +0000 +0000'>August 4, 2011</span>&nbsp;·&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Activesync issue on Exchange 2010" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/04/activesync-issue-on-exchange-2010/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/tags/exchange/page/2/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net">PetterTech</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
