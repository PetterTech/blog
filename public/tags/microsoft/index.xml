<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>microsoft on PetterTech</title>
    <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/tags/microsoft/</link>
    <description>Recent content in microsoft on PetterTech</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 04 Oct 2012 12:07:10 +0000</lastBuildDate><atom:link href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/tags/microsoft/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Powershell function for enabling a user for Lync and configure settings</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/10/04/powershell-function-for-enabling-a-user-for-lync-and-configure-settings/</link>
      <pubDate>Thu, 04 Oct 2012 12:07:10 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/10/04/powershell-function-for-enabling-a-user-for-lync-and-configure-settings/</guid>
      <description>A little while ago I posted a script for enabling users for Lync and settings some settings for that user. That script has been used here ever since I posted it and it has worked like a charm. However there‚Äôs always room for improvement, right?.
So I have made a function out of it and for the first time (I think) I have even implemented some error handling. The function is also improved quit a bit on the help section and the info that is shown to the user after the function completes.</description>
    </item>
    
    <item>
      <title>Powershell function for rotating event logs</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/09/06/powershell-function-for-rotating-event-logs/</link>
      <pubDate>Thu, 06 Sep 2012 10:13:33 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/09/06/powershell-function-for-rotating-event-logs/</guid>
      <description>A friend of mine came to me with an interesting powershell challenge today: how can I use powershell to archive and clear event logs?
Well, challenge accepted!
The reason the challenge arose is due to maintenance he performs on a number of customer servers. Every month he saves each eventlog and clears it manually, a time consuming task if you have more than a few servers.
So here‚Äôs what I came up with:</description>
    </item>
    
    <item>
      <title>Function for adding photo in Active Directory</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/08/24/function-for-adding-photo-in-active-directory/</link>
      <pubDate>Fri, 24 Aug 2012 13:16:30 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/08/24/function-for-adding-photo-in-active-directory/</guid>
      <description>I have always been careful to avoid the really advanced and cool stuff in Powershell, like functions, arrays and such.
But as I created the last script it hit me that it would be really cool to have it in a command, like set-adphoto. After some googling I found that funtions aren‚Äôt hard at all!
Basically all I really had to do with the ad photo import script was to add¬†‚Äúfunction Set-ADPhoto { ‚Äù in front of the script and end it with a }</description>
    </item>
    
    <item>
      <title>Check if DAG databases is on preferred server</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/04/30/check-if-dag-databases-is-on-preferred-server/</link>
      <pubDate>Mon, 30 Apr 2012 10:35:57 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/04/30/check-if-dag-databases-is-on-preferred-server/</guid>
      <description>If you are using DAG in exchange 2010 for high availability on your mailboxes there may be one thing you might have noticed, the databases can fail over to a less preferred server at any time without you noticing.
Microsoft have provided you with a script for balancing these databases, RedistributeActiveDatabases.ps1. With this script you can activate the databases on their preferred server again. But how do you know when they have failed over?</description>
    </item>
    
    <item>
      <title>Redirecting a webpage using html</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/02/27/redirecting-a-webpage-using-html/</link>
      <pubDate>Mon, 27 Feb 2012 07:55:57 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/02/27/redirecting-a-webpage-using-html/</guid>
      <description>The redirect function in IIS 7 and 7.5 is in my experience pretty buggy. More often than not it will send the visitor into an eternal redirect loop.
Because of that I have used this simple html code for redirecting, instead of using the built in function in IIS.
Use it at your own will, I‚Äôm just posting it so I know where to find it the next time I need it üôÇ</description>
    </item>
    
    <item>
      <title>Grep&#39;ing the eventlog using powershell</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/02/20/greping-the-eventlog-using-powershell/</link>
      <pubDate>Mon, 20 Feb 2012 09:27:42 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2012/02/20/greping-the-eventlog-using-powershell/</guid>
      <description>If you are used to working with Linux you‚Äôre probably familiar with using tail, grep and such for gathering stuff from logs and other files. Those are quite useful tools and work very well when you want to find out e.g. why a user fails to log in.
In Windows it‚Äôs a little different, if we want to find something in the event logs we have always had to resort to a console.</description>
    </item>
    
    <item>
      <title>Mass import of users in Active Directory v2 ‚Äì Powershell time</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/10/27/mass-import-of-users-in-active-directory-v2-powershell-time/</link>
      <pubDate>Thu, 27 Oct 2011 19:54:21 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/10/27/mass-import-of-users-in-active-directory-v2-powershell-time/</guid>
      <description>Earlier I posted a script that created users and homefolders and added the users to specified groups. It also set ntfs permissions on the homefolders.
That script used primarily old fashioned stuff, so I sat down and started looking for a neat way to do the same in powershell.
The powershell script I came up does a lot more than the last one. Here a little list:
Creates OUs Creates users Creates security groups Creates distribution groups Creates mailboxes for all users Add specified users to the correct security and distribution groups Creates a homefolder root folder and shares it Creates a homefolder for each user and sets ntfs permissions Set storage limit on the exchange mailbox database As you can see, it does quite a lot.</description>
    </item>
    
    <item>
      <title>Simple powershell script for enabling users for Lync</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/10/12/simple-powershell-script-for-enabling-users-for-lync/</link>
      <pubDate>Wed, 12 Oct 2011 15:59:45 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/10/12/simple-powershell-script-for-enabling-users-for-lync/</guid>
      <description>I wrote this simple little script for enabling users for Lync. It asks for input on name, sipdomain and line uri. The rest is set using variables defined at the start of the script.
If you only have one sipdomain you can change the script so that it doesn‚Äôt ask for it.
Here‚Äôs the script in all its glory:
$UI = (Get-Host).UI.RawUI $UI.WindowTitle = &amp;#34;Enable lync user&amp;#34; Import-Module Lync #Setting some variables $registrarpool = lyncpool.</description>
    </item>
    
    <item>
      <title>Install and configure Exchange 2010 using Powershell</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/29/install-and-configure-exchange-2010-using-powershell/</link>
      <pubDate>Thu, 29 Sep 2011 06:51:38 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/29/install-and-configure-exchange-2010-using-powershell/</guid>
      <description>In this guide I will show you how to install and configure a simple Exchange 2010 environment using no gui at all.
Installing exchange 2010 without gui may seem kinda nerdy, but it‚Äôs quite useful for quickly setting up a test environment for example.
Remember to run Windows update prior to the installation.
Start powershell as administrator and type:
import-module servermanager First we need to install all of the prerequisites:</description>
    </item>
    
    <item>
      <title>Setting NTFS permissions using Powershell</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/23/setting-ntfs-permissions-using-powershell/</link>
      <pubDate>Fri, 23 Sep 2011 11:19:28 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/23/setting-ntfs-permissions-using-powershell/</guid>
      <description>I am currently working on a script similar to the Mass import of users in Active Direcory post I published earlier (as promised üôÇ ). In the new script I wanted to only use powershell, so I had to find a way to set ntfs permissions using powershell. After all, the cacls way is pretty outdated.
After some googling I came up with a rather extensive script, it is a little more complicated than I wanted but here goes:</description>
    </item>
    
    <item>
      <title>Robocopy backup script</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/13/robocopy-backup-script/</link>
      <pubDate>Tue, 13 Sep 2011 13:03:29 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/13/robocopy-backup-script/</guid>
      <description>This is a script I have used on several of my relatives computers for backing up their data. Windows backup won‚Äôt do for them because they feel the need to see the actual files on the external drive‚Ä¶
Anyway, heres my script:
robocopy c:users&amp;amp;lt;username&amp;amp;gt; &amp;amp;lt;destination&amp;amp;gt; /MIR /XD templates start-menu &amp;#34;local settings&amp;#34; appdata &amp;#34;internal video&amp;#34; cookies &amp;#34;my music&amp;#34; &amp;#34;my pictures&amp;#34; &amp;#34;my documents&amp;#34; printers programdata recent sendto andrmask /XF ntuser.dat ntuser.dat.log1 ntuser.dat.log2 /R:5 /LOG:&amp;amp;lt;log destination&amp;amp;gt; I guess a little explanation is required.</description>
    </item>
    
    <item>
      <title>Enable Resource Booking Attendant on all Room Mailboxes</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/12/enable-resource-booking-attendant-on-all-room-mailboxes/</link>
      <pubDate>Mon, 12 Sep 2011 12:28:56 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/12/enable-resource-booking-attendant-on-all-room-mailboxes/</guid>
      <description>The Resource Booking Attendant should be enabled on all your Room Mailboxes. If it is not, the room will not accept or decline incoming meeting requests. Which is somewhat the whole point right?
Heres a powershell command to enable it on all the Room Mailboxes in an exchange organization:
Get-Mailbox -RecipientTypeDetails roommailbox | Set-CalendarProcessing -AutomateProcessing AutoAccept </description>
    </item>
    
    <item>
      <title>Mass import of users in Active Directory</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/07/mass-import-of-users-in-active-directory/</link>
      <pubDate>Tue, 06 Sep 2011 23:10:38 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/09/07/mass-import-of-users-in-active-directory/</guid>
      <description>Tried sleeping‚Ä¶‚Ä¶That obviously didn‚Äôt work out, so here‚Äôs a guide on how to import a number of users in Active Directory and then creating and sharing out their home folder.
Note: This guide uses dsadd for creating users and cacls for setting ntfs permissions. Thats kind of old fashioned, I will try to write a new guide using powershell later on.
In the scenario I have created this script for we have a domain controller who happens to also be the file server, file01.</description>
    </item>
    
    <item>
      <title>Quick guide for setting up Libraries in Windows 7</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/23/quick-guide-for-setting-up-libraries-in-windows-7/</link>
      <pubDate>Tue, 23 Aug 2011 06:09:54 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/23/quick-guide-for-setting-up-libraries-in-windows-7/</guid>
      <description>Libraries can be a nice feature to use if you have your pictures, music, movies and whatnot spread across several different locations, be that discs, servers or folders.
It‚Äôs really simple to setup too!
Open up explorer and look to your left, there you will see the default Libraries Windows has set up.
You can use the default Libraries as a starting point, or you can create a new one by right-clicking Libraries New‚Äì&amp;gt;Library</description>
    </item>
    
    <item>
      <title>Editing permissions on all mailboxes in one command, Exchange 2010/2007</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/18/editing-permissions-on-all-mailboxes-in-one-command-exchange-20102007/</link>
      <pubDate>Thu, 18 Aug 2011 07:44:23 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/18/editing-permissions-on-all-mailboxes-in-one-command-exchange-20102007/</guid>
      <description>If you have some sort of 3rd-party application that needs access to all of your mailboxes, it can be a pain to set the permissions on all of your mailboxes.
Except if you use this nice little powershell command:
Get-Mailbox -ResultSize unlimited | Add-MailboxPermission -User admin -AccessRights FullAccess -InheritanceType all What this command will do is to add Full mailbox access to every mailbox in your Exchange organization for the user admin.</description>
    </item>
    
    <item>
      <title>Receive connector allowing anonymous relay on exchange 2010/2007</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/17/receive-connector-allowing-anonymous-relay-on-exchange-20102007/</link>
      <pubDate>Wed, 17 Aug 2011 14:27:32 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/17/receive-connector-allowing-anonymous-relay-on-exchange-20102007/</guid>
      <description>Often it‚Äôs a good idea to have a receive connector allowing certain devices to send mail through you exchange server without having to authenticate.
One example from where I currently work is printers.
We never set up the printers ourselves, that job is done by the provider. And do we want to give them a username and password allowing for mail relay through our servers? No, we don‚Äôt.
It‚Äôs a better practice to have them only input the name/ip-address of one exchange server with the cas role.</description>
    </item>
    
    <item>
      <title>Activesync issue on Exchange 2010</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/04/activesync-issue-on-exchange-2010/</link>
      <pubDate>Thu, 04 Aug 2011 09:56:46 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/04/activesync-issue-on-exchange-2010/</guid>
      <description>At work we are currently migrating to a new active directory domain. The migration hos gone rather smoothly except for a couple of users who are not able to sync mail on their phones.
After a little research I found the following events in the event log on our exchange CAS server:
Log Name: Application
Source: MSExchange ActiveSync
Date: 04.08.2011 11:00:48
Event ID: 1053
Task Category: Configuration
Level: Error
Keywords: Classic</description>
    </item>
    
    <item>
      <title>Deploying Microsoft Hyper-V Server 2008 R2 on USB Flash Drive</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/03/deploying-microsoft-hyper-v-server-2008-r2-on-usb-flash-drive/</link>
      <pubDate>Wed, 03 Aug 2011 12:04:31 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/03/deploying-microsoft-hyper-v-server-2008-r2-on-usb-flash-drive/</guid>
      <description>Just thought I should share this link:
http://technet.microsoft.com/en-us/library/ee731893(WS.10).aspx
I have tried this on a HP DL380 G6 and it worked like a charm.
One of the advantages of using that kind of server is that it has internal usb ports so you don‚Äôt have to worry about someone accidentally unplugging the usb drive.
Why should I run a server os from a usb drive you may ask. Well, the biggest advantage is that if your storing all virtual machines on e.</description>
    </item>
    
    <item>
      <title>Set event logging for the offline address list generator to medium</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/03/set-event-logging-for-the-offline-address-list-generator-to-medium/</link>
      <pubDate>Wed, 03 Aug 2011 06:48:06 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/08/03/set-event-logging-for-the-offline-address-list-generator-to-medium/</guid>
      <description>In a default exchange 2007/2010 installation the logging level for OALGen is set to lowest. That means that if you have users who do not show up in the Global address list (GAL) or they are missing some info, you will only see the following events in the event log:
Log Name: Application
Source: MSExchangeSA
Date: 03.08.2011 08:15:18
Event ID: 9320 Task Category: (13)
Level: Warning
Keywords: Classic
User: N/A</description>
    </item>
    
    <item>
      <title>ALTools from Microsoft, awesome!</title>
      <link>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/06/09/altools-from-microsoft-awesome/</link>
      <pubDate>Thu, 09 Jun 2011 11:39:13 +0000</pubDate>
      
      <guid>https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2011/06/09/altools-from-microsoft-awesome/</guid>
      <description>Stumbled upon a tool from Microsoft called ALTools that I thought were absolutely awesome. It‚Äôs over 7 years old so I wonder why I haven‚Äôt seen it before
Nevertheless it‚Äôs as cool now as it was when it was released.
ALTools consists of several tools, but the coolest of them are:
aloinfo ‚Äì Displays all user account names and the age of their passwords eventcombMT ‚Äì Gathers specific events from event logs of several different machines and saves them in a text file LockoutStatus ‚Äì Shows a list of all domain controllers in a given domain and the lockoutstatus of a given user on those I have used eventcomb a couple of times as it has some predefined searches, for example Account Lockouts.</description>
    </item>
    
  </channel>
</rss>
