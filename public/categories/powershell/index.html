<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Powershell | PetterTech</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/categories/powershell/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bf5f9f73cf17311d52cedbcda82c922e91b2f566d88a85ad9f5b5a08b586bd5f.css" integrity="sha256-v1&#43;fc88XMR1SztvNqCySLpGy9WbYioWtn1taCLWGvV8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/apple-touch-icon.png">
<link rel="mask-icon" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/categories/powershell/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Powershell" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/categories/powershell/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Powershell"/>
<meta name="twitter:description" content=""/>

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net" accesskey="h" title="PetterTech (Alt + H)">PetterTech</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>
    Powershell
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Powershell: Getting monitor info
    </h2>
  </header>
  <div class="entry-content">
    <p>Today I got a request from a colleague of mine that was doing inventory: What are the make, model, serial number and purchase date of your monitors?
Seeing as this wasn‚Äôt something I had readily in my head I had to figure it out, but being the automation enthusiast that I am, I refused to bend over my monitors and snap a photo of it all. I wanted to find it a cooler way, the powershell way üôÇ...</p>
  </div>
  <footer class="entry-footer"><span title='2019-08-26 12:12:56 +0000 +0000'>August 26, 2019</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Powershell: Getting monitor info" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2019/08/26/powershell-getting-monitor-info/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Powershell and the HPE 3PAR REST API
    </h2>
  </header>
  <div class="entry-content">
    <p>Lately, I‚Äôve had the pleasure of using Powershell to automate some of the basic tasks we do on our HPE 3PAR systems: creating volumes, adding them to volume sets, exporting them and so on.
Since my experience with REST APIs was rather limited it was quite daunting at first but once you get the hang of how REST works and the Invoke-RestMethod cmdlet it‚Äôs really not that bad.
Disclaimer: The examples below will vary somewhat in how I do certain things, simply because I had to learn all this from scratch....</p>
  </div>
  <footer class="entry-footer"><span title='2017-06-15 12:01:01 +0000 +0000'>June 15, 2017</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Powershell and the HPE 3PAR REST API" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2017/06/15/powershell-and-the-hpe-3par-rest-api/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Powershell: Creating strong passwords
    </h2>
  </header>
  <div class="entry-content">
    <p>A tweet from @JanEgilRing caught my eye this morning, it¬†was showing¬†how you can use powershell to create passwords. The link in the tweet pointed here:¬†http://powershell.com/cs/blogs/tips/archive/2016/05/23/one-liner-random-password-generator.aspx
Seeing that line and realizing how simple it was, it got me thinking on¬†how I could implement this in my scripts.
The only issue I saw with that one-liner was that the passwords it creates do not necessarily comply¬†with high complexity rules....</p>
  </div>
  <footer class="entry-footer"><span title='2016-05-26 10:40:20 +0000 +0000'>May 26, 2016</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to Powershell: Creating strong passwords" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2016/05/26/powershell-creating-strong-passwords/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>PowerCLI: Function for listing snapshots
    </h2>
  </header>
  <div class="entry-content">
    <p>My very first PowerCLI related post was about this same topic: listing snapshot info using PowerCLI.
In my original post (which you can see here) I only wrote a pretty simple one-liner. Which was kind of okay, but it was missing one crucial thing: who took the snapshot?
Why vmware hasn‚Äôt found a way to include a username in the get-snapshot cmdlet is something I just can‚Äôt understand. There‚Äôs really not much code needed to add this to the output, and there‚Äôs several ways of doing so....</p>
  </div>
  <footer class="entry-footer"><span title='2014-09-17 07:16:57 +0000 +0000'>September 17, 2014</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to PowerCLI: Function for listing snapshots" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2014/09/17/powercli-function-for-listing-snapshots/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>PowerCLI: Evacuating a datastore
    </h2>
  </header>
  <div class="entry-content">
    <p>In case you ever need to empty out a datastore in you vmware environment, there is a nice little one-liner in PowerCLI for that:
Get-VM -Datastore &#34;datastore1&#34; | Move-VM -Datastore (Get-VMHost -Location &#39;cluster1&#39; | Select-Object -First 1 | Get-Datastore | Where-Object {($_.Name -ne &#39;datastore1&#39;) -and ($_.FreeSpaceGB -gt &#39;500&#39;)} |¬†Sort-Object FreeSpaceGB -Descending | Select-Object -First 1) Where ‚Äúdatastore1‚Äù is the datastore you want to empty out and ‚Äúcluster1‚Äù is the cluster where the datastore is available....</p>
  </div>
  <footer class="entry-footer"><span title='2014-09-11 10:54:40 +0000 +0000'>September 11, 2014</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to PowerCLI: Evacuating a datastore" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2014/09/11/powercli-evacuating-a-datastore/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>PowerCLI: Listing VMs with ISOs mounted
    </h2>
  </header>
  <div class="entry-content">
    <p>For almost a year ago, I posted a simple one-liner to list all VMs who has ISOs mounted. You can view that post here:¬†http://cloud.kemta.net/2013/10/powershell-vmware-list-all-vms-with-iso-mounted-and-dismount-them/
That post was written before I truly discovered the major advantages of using Get-View instead of Get-VM, Get-VMHost and so on. If used correctly, there‚Äôs a major difference in speed when using Get-View over Get-VM.
When writing this post I checked the differences in speed when using the old way that I linked to above and my new function (which I‚Äôll get to in a second or two....</p>
  </div>
  <footer class="entry-footer"><span title='2014-09-09 05:55:24 +0000 +0000'>September 9, 2014</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to PowerCLI: Listing VMs with ISOs mounted" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2014/09/09/powercli-listing-vms-with-isos-mounted/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>PowerCLI: Getting vmhost uptime
    </h2>
  </header>
  <div class="entry-content">
    <p>I love a powershell challenge, and last week a colleague of mine asked me for assistance in getting the uptime of vmware hosts. My initial response did the trick:
Get-View -ViewType hostsystem -Property name,runtime.boottime | Select-Object Name, @{N=&#34;UptimeDays&#34;; E={((((get-date) - ($_.runtime).BootTime).TotalDays).Tostring()).Substring(0,5)}} However, I wasn‚Äôt completely satisfied by the the output or the ease of use.
So today I went back and rewrote the code and made a function of it....</p>
  </div>
  <footer class="entry-footer"><span title='2014-09-08 07:26:38 +0000 +0000'>September 8, 2014</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to PowerCLI: Getting vmhost uptime" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2014/09/08/powercli-getting-vmhost-uptime/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>PowerCLI: Getting the status of vmware tools on all VMs
    </h2>
  </header>
  <div class="entry-content">
    <p>I‚Äôm sure I don‚Äôt need to explain to you guys why VMware tools is a good idea to have installed on your VMs, and probably not why it‚Äôs a good idea to keep VMware tools updated.
However, I haven‚Äôt found a good way to get a neat list of which VMs need to have their VMware tools upgraded. While working on my vCenter health check script I found that I had to make my own little script to get that list....</p>
  </div>
  <footer class="entry-footer"><span title='2014-09-05 12:06:17 +0000 +0000'>September 5, 2014</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to PowerCLI: Getting the status of vmware tools on all VMs" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2014/09/05/powercli-getting-the-status-of-vmware-tools-on-all-vms/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>PowerCLI: Getting datastore alarms
    </h2>
  </header>
  <div class="entry-content">
    <p>Next in the series on getting alarms is getting datastore alarms.
Again, the code is pretty similar:
$Datastores = Get-View -ViewType Datastore -Property Name,OverallStatus,TriggeredAlarmstate $FaultyDatastores = $Datastores | Where-Object {$_.TriggeredAlarmState -ne &#34;{}&#34;} $progress = 1 $report = @() if ($FaultyDatastores -ne $null) { foreach ($FaultyDatastore in $FaultyDatastores) { foreach ($TriggeredAlarm in $FaultyDatastore.TriggeredAlarmstate) { Write-Progress -Activity &#34;Gathering alarms&#34; -Status &#34;Working on $($FaultyDatastore.Name)&#34; -PercentComplete ($progress/$FaultyDatastores.count*100) -Id 1 -ErrorAction SilentlyContinue $entity = $TriggeredAlarm.Entity.ToString() $alarmID = $TriggeredAlarm....</p>
  </div>
  <footer class="entry-footer"><span title='2014-08-31 10:16:36 +0000 +0000'>August 31, 2014</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to PowerCLI: Getting datastore alarms" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2014/08/31/powercli-getting-datastore-alarms/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>PowerCLI: Getting cluster alarms
    </h2>
  </header>
  <div class="entry-content">
    <p>The next step in my short series on getting vCenter alarms using PowerCLI is to get cluster alarms.
Here‚Äôs the code:
$Clusters = Get-View -ViewType ComputeResource -Property Name,OverallStatus,TriggeredAlarmstate $FaultyClusters = $Clusters | Where-Object {$_.TriggeredAlarmState -ne &#34;{}&#34;} $report = @() $progress = 1 if ($FaultyClusters -ne $NULL) { foreach ($FaultyCluster in $FaultyClusters) { foreach ($TriggeredAlarm in $FaultyCluster.TriggeredAlarmstate) { Write-Progress -Activity &#34;Gathering alarms&#34; -Status &#34;Working on $($FaultyCluster.Name)&#34; -PercentComplete ($progress/$FaultyClusters.count*100) -Id 1 -ErrorAction SilentlyContinue $entity = $TriggeredAlarm....</p>
  </div>
  <footer class="entry-footer"><span title='2014-08-30 08:21:59 +0000 +0000'>August 30, 2014</span>&nbsp;¬∑&nbsp;nerenther</footer>
  <a class="entry-link" aria-label="post link to PowerCLI: Getting cluster alarms" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/index.php/2014/08/30/powercli-get-cluster-alarms/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net/categories/powershell/page/2/">Next&nbsp;&nbsp;¬ª
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://blue-cliff-0fe9f2b03.3.azurestaticapps.net">PetterTech</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
